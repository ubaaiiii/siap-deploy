SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON a.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-05-01' AND '2021-02-07' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON a.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-01-01' AND '2021-02-07' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON a.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-01-01' AND '2021-02-07' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON a.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-01-01' AND '2021-02-08' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON a.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-01-01' AND '2021-02-08' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON a.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-07-01' AND '2021-02-07' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON a.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-01-01' AND '2021-02-08' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       i.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN (select * from tr_sppa_paid WHERE  LEFT(paiddt, 10) BETWEEN '2021-01-01' AND '2021-02-28') d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       LEFT JOIN ms_master i
                              ON a.pekerjaan = i.msid
                                 AND i.mstype = 'KERJA'
                WHERE 1 SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       h.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar Premi',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       IF (status < 20 AND status <> 12,
                          IF (validdt IS NOT NULL,
                              IF (Datediff(Curdate(), validdt) > 90, 
                              'Pengajuan Expired (sudah valid)', 
                              Date_add(validdt, INTERVAL 90 day)),
                              IF (Datediff(Curdate(), a.createdt) > 90, 
                              'Pengajuan Expired', 
                              Date_add(a.createdt, INTERVAL 90 day))),
                          NULL) 'Tgl Pengajuan Expired'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid
                                 AND d.paidtype = 'PREMI'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                WHERE  LEFT(a.createdt, 10) BETWEEN '2021-01-01' AND '2021-02-08'SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON a.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2021-01-01' AND '2021-02-28' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2021-01-01' AND '2021-02-28' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-01-01' AND '2021-02-08' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2021-01-01' AND '2021-02-28' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2021-01-01' AND '2021-02-28' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2021-01-01' AND '2021-02-28' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2021-01-01' AND '2021-02-28' SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(h.msdesc IS NULL, pekerjaan, h.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       akhir                                     Akhir,
                       masa                                      Masa,
                       a.tunggakan                               Graceperiod,
                       up                                        UP,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       i.nama                                    'Nama AO',
                       i.username                                'Username AO',
                       a.createdt                                'Tgl Input'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status IN ( '11' )
                       AND LEFT(a.createdt, 10) BETWEEN '2019-07-01' AND '2021-01-31'SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(h.msdesc IS NULL, pekerjaan, h.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       akhir                                     Akhir,
                       masa                                      Masa,
                       a.tunggakan                               Graceperiod,
                       up                                        UP,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       i.nama                                    'Nama AO',
                       i.username                                'Username AO',
                       a.createdt                                'Tgl Input'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status IN ( '2' )
                       AND LEFT(a.createdt, 10) BETWEEN '2019-07-01' AND '2021-01-31'SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(h.msdesc IS NULL, pekerjaan, h.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       a.akhir                                   Akhir,
                       a.masa,
                       a.tunggakan                               Graceperiod,
                       up                                        UP,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       i.nama                                    'Nama AO',
                       i.username                                'Username AO',
                       a.createdt                                'Tgl Input',
                       Concat('`', a.policyno)                   'No Sertifikat',
                       a.validdt                                 'Tgl Validasi'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status IN ( '5' )
                       AND LEFT(a.validdt, 10) BETWEEN '2019-07-01' AND '2021-01-31'SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-07-01' AND '2021-02-08'  AND  sp.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       i.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN (select * from tr_sppa_paid WHERE  LEFT(paiddt, 10) BETWEEN '2021-01-01' AND '2021-01-31') d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       LEFT JOIN ms_master i
                              ON a.pekerjaan = i.msid
                                 AND i.mstype = 'KERJA'
                WHERE 1 SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2021-02-01' AND '2021-02-09'  AND  sp.cabang='32'SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2015-01-09' AND '2021-02-09'  AND  sp.cabang='28'SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2016-01-01' AND '2021-02-09'  AND  sp.cabang='21'SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-07-01' AND '2021-02-10'  AND  sp.asuransi =  'TKP'SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-07-01' AND '2021-01-31' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2018-01-01' AND '2021-02-11'  AND  sp.cabang='2'SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-06-01' AND '2021-02-11' SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2020-01-01' AND '2021-02-22'  AND  sp.cabang='33'SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-01-01' AND '2021-02-15'  AND  sp.cabang='33'SELECT f.msdesc Produk,
                	Concat('`', cl.regid) AS 'No Register',
                    Concat('`', sp.policyno) AS 'No Sertifikat',
                    nopeserta AS 'No Pinjaman',
                	sp.nama AS 'Nama',
                    jkel AS 'Jenis Kelamin',
                    kj.msdesc AS 'Pekerjaan',
                    cb.msdesc AS 'Cabang',
                    tgllahir AS 'Tgl Lahir',
                	mulai AS 'Tgl Mulai',
                    Concat('`', noktp) AS 'No KTP',
                    akhir AS 'Tgl Akhir',
                    masa AS 'Masa(bulan)',
                    tunggakan AS 'Grace Period',
                    up AS 'Plafond',
                    tpremi AS 'Premi',
                    ins.msdesc AS 'Asuransi',
                    st.msdesc AS 'Status',
                    ad.nama AS 'Nama AO',
                    ad.username AS 'Username AO',
                    sp.createdt AS 'Tgl Input',
                    pd.paiddt AS 'Tgl Bayar Premi',
                    pd.paidamt  AS 'Jml Bayar Premi',
                    Concat('`', regclaim) AS 'No Claim',
                    tglkejadian AS 'Tgl Kejadian',
                	tgllapor AS 'Tgl Lapor Claim',
                    nilaios AS 'Nilai OS',
                    -- processdt AS 'Tgl Proses (Verif/Rollback)',
                    DATE_ADD(tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                    sp.validdt AS 'Tgl Validasi',
                	cl.validdt AS 'Tgl Valid Claim',
                	lg.createdt  AS 'Tgl Reject Claim',
                    rj.msdesc AS 'Alasan Reject',
                    cl.comment as 'Keterangan',
                    lgd.createdt  AS 'Tgl Terima Dokumen',
                    pdc.paiddt AS 'Tgl Bayar Claim',
                    pdc.paidamt AS 'Jml Bayar Claim',
                    IF (dok.hasil IS NULL,
                		'Lengkap',
                        'Belum Lengkap')   'Status Dokumen',
                	kurang.kelengkapan	     Kekurangan
                FROM tr_claim cl
                INNER JOIN (select * from tr_sppa where  status IN ( '90', '91', '92', '93', '94', '95', '96' ) )sp
                	ON cl.regid = sp.regid
                LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='PREMI') pd
                	ON cl.regid = pd.regid
                 LEFT JOIN (select regid,paiddt,paidamt from tr_sppa_paid where paidtype='CLAIM') pdc
                	ON cl.regid = pdc.regid
                LEFT JOIN (select * from tr_sppa_log where status=94) lg 
                	ON cl.regid = lg.regid
                LEFT JOIN (select * from tr_sppa_log where status=96) lgd 
                	ON cl.regid = lgd.regid
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='KERJA') kj
                	ON kj.msid = sp.pekerjaan
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='CAB') cb
                	ON cb.msid = sp.cabang
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='ASURANSI') ins
                	ON ins.msid = sp.asuransi
                LEFT JOIN (SELECT msid, msdesc FROM ms_master WHERE mstype='STREQ') st
                	ON st.msid = sp.status
                LEFT JOIN (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                	ON wkc.msid = concat(asuransi,produk)
                LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') rj
                	ON rj.msid = cl.detail
                LEFT JOIN ms_admin ad
                	ON ad.username = sp.createby
				INNER JOIN ms_master f ON sp.produk = f.msid AND f.mstype = 'produk'
                LEFT JOIN ( SELECT 
                           		a.regid,
                          		GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                          			'Dokumen Belum Lengkap',
                          			null) SEPARATOR ', ') hasil
                        	FROM tr_claim a
                                INNER JOIN ms_master b
                                          ON b.mstype = a.doctype
                                             AND b.editby = 'wajib'
                                LEFT JOIN tr_document c
                                          ON c.regid = a.regid
                                             AND c.jnsdoc = b.msid
                        	WHERE b.createby IS NULL
                        		AND c.jnsdoc IS NULL
                        	GROUP BY regid) dok
                ON dok.regid = cl.regid
                LEFT JOIN ( SELECT
                                a.regid,
                                GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
            				FROM tr_claim a
                            INNER JOIN ms_master b 
                            	ON a.doctype = b.mstype  
                            LEFT JOIN tr_document c
                                ON c.regid = a.regid
                                AND c.jnsdoc = b.msid
                            WHERE b.editby = 'wajib' and c.jnsdoc is null
                            GROUP BY a.regid) kurang
                	ON kurang.regid = cl.regid
                WHERE  
                LEFT(cl.tgllapor, 10) BETWEEN '2019-01-01' AND '2021-02-15' 