select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11','12') and left(a.createdt,10) between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt) between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11','12') and left(a.createdt,10) between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt) between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-10-01'	and '2020-02-06'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2019-10-01'	and '2020-02-06'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('90','91','92','93','94') and left(a.mulai,10) between '2019-10-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-07-01'	and '2020-01-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2019-07-01'	and '2020-01-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi, g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-01'	and '2020-02-06'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi, g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-01'	and '2020-02-06'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-06'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-02-01'	and '2020-02-06'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-05'	and '2020-02-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-01-31'  and  a.cabang = '9' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='ASTRIM3167' or a.parent='ASTRIM3167')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-01-31'  and  a.cabang = '9' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='ASTRIM3167' or a.parent='ASTRIM3167')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-01-31'  and  a.cabang = '9' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='ASTRIM3167' or a.parent='ASTRIM3167')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-01-31'  and  a.cabang = '9' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='ASTRIM3167' or a.parent='ASTRIM3167')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-06'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-02-07'	and '2020-02-07'  and  a.cabang = '9' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='ASTRIM3167' or a.parent='ASTRIM3167')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-07'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-07' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-07' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-07'	and '2020-02-07' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-07'	and '2020-02-07' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-10' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-03'	and '2020-02-07' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-01-01'	and '2020-01-31'  and  a.cabang = '33' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUSRAN0663' or a.parent='YUSRAN0663')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('12') and left(a.createdt,10) between '2020-02-01'	and '2020-02-11' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2020-02-01'	and '2020-02-11' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-01-01'	and '2020-01-31'  and  a.cabang = '35' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='ANDRIA2128' or a.parent='ANDRIA2128')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2020-02-01'	and '2020-02-11'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-11'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-01-01'	and '2020-02-11'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-10' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-10'	and '2020-02-10' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-10' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-10'	and '2020-02-10' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-10' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-01'	and '2020-02-10' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and left(a.createdt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-02-10'  and  a.cabang =  '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-11'	and '2020-02-11' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-11'	and '2020-02-11' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-11' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-01-24'	and '2020-02-12'  and  a.produk = 'PR01'  and  a.cabang = '6' and  a.asuransi =  'TKP' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='VANDAL4479' or a.parent='VANDAL4479')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-12' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-12'	and '2020-02-12' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-12' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-14'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.mselect f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-14'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-24'	and '2020-02-14' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2019-07-01'	and '2019-08-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2019-09-01'	and '2019-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2019-11-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-29' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-14' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-14' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-13' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-13'	and '2020-02-13' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-13' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-13' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-17'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-14' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-14'	and '2020-02-14' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-14' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-14' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('90','91','92','93','94') and left(a.mulai,10) between '2020-01-01'	and '2020-02-29' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('90','91','92','93','94') and left(a.mulai,10) between '2019-09-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-29'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-29'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-29'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-29'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-17' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-17'	and '2020-02-17' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-17' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-02-17' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-01-14'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-14'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-14'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi, g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-14'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in  ('7','71','72','73')  and a.createdt between '2020-01-14'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('12') and left(a.createdt,10) between '2020-01-14'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('12') and left(a.createdt,10) between '2020-01-14'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-18'  and  a.cabang = '12'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid    where   left(a.createdt,10)  between '2019-12-01'	and '2020-02-29'  and  a.cabang = '12'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2019-07-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and a.createdt between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-18'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-01-01'	and '2020-01-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi, g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-18'	and '2020-02-18'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi, g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-17'	and '2020-02-17'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi, g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-14'	and '2020-02-14'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  left(d.paiddt,10) between '2020-02-14'	and '2020-02-14'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '49' and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '49' and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and left(a.createdt,10) between '2020-01-01'	and '--'  and  a.cabang = '' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FAUZIA3197' or a.parent='FAUZIA3197')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  a.status='20' and left(a.createdt,10) between '2020-01-01'	and '2020-02-19'  and  a.cabang = '' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FAUZIA3197' or a.parent='FAUZIA3197')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31'  and  a.cabang =  '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-02-18'  and  a.cabang =  '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-01'	and '2020-02-18' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  left(d.paiddt,10) between '2020-02-01'	and '2020-02-19'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner  join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where  left(d.paiddt,10) between '2020-02-01'	and '2020-02-19'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-18' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-02-18' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-18'	and '2020-02-18' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid    where   left(d.paiddt,10) between '2020-02-01'	and '2020-02-18' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-01'	and '2020-02-18' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-02-01'	and '2020-02-19'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-01'	and '2020-02-18' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-01'	and '2020-02-18' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar, (i.msdesc + i.createby) - DATEDIFF(day, h.tglkejadian, now()) 'SisaWaktu'  from tr_sppa a  inner join tr_claim h ON a.regid=h.regid  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-07-21' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar, (i.msdesc + i.createby) - DATEDIFF(day, h.tglkejadian, now()) 'SisaWaktu'  from tr_sppa a  inner join tr_claim h ON a.regid=h.regid  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-07-21' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar, (i.msdesc + i.createby) - DATEDIFF(day, h.tglkejadian, now()) 'SisaWaktu'  from tr_sppa a  inner join tr_claim h ON a.regid=h.regid  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-07-21' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar,  IF (a.status IN ('90','91','92'),
		                IF (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian) > 0,
		                    CONCAT (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian),' hari'),
		                    'Expired'),
		                null) 'SisaWaktu',  j.createdt 'DokumenDiterima'  from tr_sppa a  inner join tr_claim h ON a.regid=h.regid  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_log j on j.regid = a.regid and j.status = '96'  left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-07-21' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar,  IF (a.status IN ('90','91','92'),
		                IF (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian) > 0,
		                    CONCAT (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian),' hari'),
		                    'Expired'),
		                null) 'SisaWaktu',  j.createdt 'DokumenDiterima'  from tr_sppa a  inner join tr_claim h ON a.regid=h.regid  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_log j on j.regid = a.regid and j.status = '96'  left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-07-22' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar,  IF (a.status IN ('90','91','92'),
		                IF (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian) > 0,
		                    CONCAT (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian),' hari'),
		                    'Expired'),
		                null) 'SisaWaktu',  j.createdt 'DokumenDiterima'  from tr_sppa a  inner join tr_claim h ON a.regid=h.regid  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_log j on j.regid = a.regid and j.status = '96'  left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-07-22' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar,  IF (a.status IN ('90','91','92'),
		                IF (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian) > 0,
		                    CONCAT (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian),' hari'),
		                    'Expired'),
		                null) 'SisaWaktu',  j.createdt 'DokumenDiterima',k.createdt 'TglRejectClaim'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join tr_claim h ON a.regid=h.regid  left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_log j on j.regid = a.regid and j.status = '96'  left join tr_sppa_log k on k.regid=a.regid and k.status='94'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-06-30'	and '2020-07-25' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,a.validdt,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar,  IF (a.status IN ('90','91','92'),
		                IF (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian) > 0,
		                    CONCAT (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian),' hari'),
		                    'Expired'),
		                null) 'SisaWaktu',  j.createdt 'DokumenDiterima',k.createdt 'TglRejectClaim'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join tr_claim h ON a.regid=h.regid  left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_log j on j.regid = a.regid and j.status = '96'  left join tr_sppa_log k on k.regid=a.regid and k.status='94'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2020-01-01'	and '2020-07-29' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2019-07-01'	and '2020-07-29' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,a.validdt tglvalidasi,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar,  IF (a.status IN ('90','91','92'),
		                IF (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian) > 0,
		                    CONCAT (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian),' hari'),
		                    'Expired'),
		                null) 'SisaWaktu',  j.createdt 'DokumenDiterima',k.createdt 'TglRejectClaim'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join tr_claim h ON a.regid=h.regid  left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_log j on j.regid = a.regid and j.status = '96'  left join tr_sppa_log k on k.regid=a.regid and k.status='94'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-07-29' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,a.validdt tglvalidasi,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar,  IF (a.status IN ('90'),
		                IF (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian) > 0,
		                    CONCAT (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian),' hari'),
		                    'Expired'),
		                null) 'SisaWaktu',  j.createdt 'DokumenDiterima',k.createdt 'TglRejectClaim'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join tr_claim h ON a.regid=h.regid  left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_log j on j.regid = a.regid and j.status = '96'  left join tr_sppa_log k on k.regid=a.regid and k.status='94'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-07-29' SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    Noregister,
                      a.nopeserta             Nopinjaman,
                      a.nama,
                      Concat('`', a.noktp)    noktp,
                      jkel,
                      pekerjaan,
                      b.msdesc                cabang,
                      tgllahir,
                      mulai,
                      a.akhir,
                      a.masa,
                      a.tunggakan             graceperiod,
                      up,
                      tpremi                  premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'status',
                      a.createdt              tglinput,
                      a.validdt               tglvalidasi,
                      Concat('`', a.policyno) nosertifikat,
                      e.paiddt                tglbayarpremi,
                      e.paidamt               JmlbayarPremi,
                      h.tglbatal,
                      h.sisa,
                      d.paiddt                tglrefundbayar,
                      h.refund                refundbayar
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2019-07-01' AND '2020-07-29'select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,a.validdt tglvalidasi,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar,  IF (a.status IN ('90'),
		                IF (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian) > 0,
		                    CONCAT (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian),' hari'),
		                    'Expired'),
		                null) 'SisaWaktu',  j.createdt 'DokumenDiterima',k.createdt 'TglRejectClaim'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join tr_claim h ON a.regid=h.regid  left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_log j on j.regid = a.regid and j.status = '96'  left join tr_sppa_log k on k.regid=a.regid and k.status='94'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-07-30' SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    Noregister,
                      a.nopeserta             Nopinjaman,
                      a.nama,
                      Concat('`', a.noktp)    noktp,
                      jkel,
                      pekerjaan,
                      b.msdesc                cabang,
                      tgllahir,
                      mulai,
                      a.akhir,
                      a.masa,
                      a.tunggakan             graceperiod,
                      up,
                      tpremi                  premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'status',
                      a.createdt              tglinput,
                      a.validdt               tglvalidasi,
                      Concat('`', a.policyno) nosertifikat,
                      e.paiddt                tglbayarpremi,
                      e.paidamt               JmlbayarPremi,
                      h.tglbatal,
                      h.sisa,
                      d.paiddt                tglrefundbayar,
                      h.refund                refundbayar
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2019-07-01' AND '2020-07-30'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2019-07-01'	and '2020-07-30' select f.msdesc produk,concat('`',a.regid) Noregister,concat('`',a.policyno) nosertifikat,a.nopeserta nopinjaman,a.nama, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,concat('`',a.noktp) noktp, akhir,masa,a.tunggakan graceperiod, a.up,tpremi premi,g.msdesc asuransi,c.msdesc status,a.createdt tglinput, e.paiddt tglbayarpremi,e.paidamt JmlbayarPremi, concat('`',h.regclaim ) Noclaim,h.tglkejadian,h.tgllapor,a.validdt tglvalidasi,h.nilaios,IFNULL(l.sdoc,0) documentupload ,  d.paiddt tglclaimbayar,d.paidamt jmlbayar,  IF (a.status IN ('90'),
		                IF (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian) > 0,
		                    CONCAT (( i.msdesc + i.createby ) - DATEDIFF(Now(), h.tglkejadian),' hari'),
		                    'Expired'),
		                null) 'SisaWaktu',  j.createdt 'DokumenDiterima',k.createdt 'TglRejectClaim'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='CLAIM'  left join tr_sppa_paid e on e.regid=a.regid  and e.paidtype='PREMI'  inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join tr_claim h ON a.regid=h.regid  left join ms_master i on i.msid = concat(a.asuransi,a.produk) and i.mstype='wktclm'  left join tr_sppa_log j on j.regid = a.regid and j.status = '96'  left join tr_sppa_log k on k.regid=a.regid and k.status='94'  left join (select regid,count(1) sdoc  from tr_document where catdoc='CLM' group by regid) l on l.regid=a.regid  where a.status in ('90','91','92','93','94','95') and left(h.tgllapor,10) between '2019-07-01'	and '2020-08-05' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    Masa(bulan),
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       Ifnull(l.sdoc, 0)       documentupload,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN (SELECT regid,
                                         Count(1) sdoc
                                  FROM   tr_document
                                  WHERE  catdoc = 'CLM'
                                  GROUP  BY regid) l
                              ON l.regid = a.regid
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-08-05'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       Ifnull(l.sdoc, 0)       documentupload,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN (SELECT regid,
                                         Count(1) sdoc
                                  FROM   tr_document
                                  WHERE  catdoc = 'CLM'
                                  GROUP  BY regid) l
                              ON l.regid = a.regid
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-08-05'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       IF (m.jmldokumen <= n.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Softcopy',
                       Ifnull(l.sdoc, 0)       documentupload,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN (SELECT regid,
                                         Count(1) sdoc
                                  FROM   tr_document
                                  WHERE  catdoc = 'CLM'
                                  GROUP  BY regid) l
                              ON l.regid = a.regid
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) m
                              ON m.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) n
                              ON n.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-08-05'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-08-05'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-08-25'	and '2020-08-25' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-08-25'	and '2020-08-25' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-07-01'	and '2020-09-28' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-07-01'	and '2020-09-28' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2020-03-01'	and '2020-03-31' SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    Noregister,
                      a.nopeserta             Nopinjaman,
                      a.nama,
                      Concat('`', a.noktp)    noktp,
                      jkel,
                      pekerjaan,
                      b.msdesc                cabang,
                      tgllahir,
                      mulai,
                      a.akhir,
                      a.masa,
                      a.tunggakan             graceperiod,
                      up,
                      tpremi                  premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'status',
                      a.createdt              tglinput,
                      a.validdt               tglvalidasi,
                      Concat('`', a.policyno) nosertifikat,
                      e.paiddt                tglbayarpremi,
                      e.paidamt               JmlbayarPremi,
                      h.tglbatal,
                      h.sisa,
                      d.paiddt                tglrefundbayar,
                      h.refund                refundbayar
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2020-03-01' AND '2020-03-31'select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-07-01'	and '2020-09-28' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-09-28' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-09-28' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2019-09-30' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-03'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-03'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-03'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-03' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-02'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-02'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-02'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-02'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-02'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-02'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       a.validdt               TglValidasi,
                       h.nilaios               NilaiOS,
                       l.jmldokumen            'SyaratDokumen',
                       m.uploaded              'DokumenDiupload',
                       IF (l.jmldokumen <= m.uploaded,
                            'Lengkap',
                            'Belum Lengkap')   'Dokumen',
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       If (a.status IN ( '90' ),
                            If (( i.msdesc + i.createby ) - Datediff(Now(), h.tglkejadian) > 0,
                                Concat (( i.msdesc + i.createby ) - Datediff(Now(),
                                        h.tglkejadian),
                                        ' hari'),
                                'Expired'),
                            NULL)              'SisaWaktu',
                       j.createdt              'DokumenDiterima',
                       k.createdt              'TglRejectClaim'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                WHERE  a.status IN ( '90', '91', '92', '93', '94', '95' )
                    AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-05'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,concat(h.comment,a.comment) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,TRIM(TRAILING '
' FROM concat(h.comment,' ',a.comment)) Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,REPLACE(concat(h.comment,' ',a.comment),'
','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,REPLACE(concat(h.comment,' ',a.comment),'
','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman ,REPLACE(concat(h.comment,' ',a.comment),'
','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-05' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       d.paidamt               JmlBayarClaim,
                       a.validdt               TglValidClaim,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       k.createdt              TglRejectClaim
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan,
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-06'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       d.paidamt               JmlBayarClaim,
                       a.validdt               TglValidClaim,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       k.createdt              TglRejectClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	   Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-06'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       d.paidamt               JmlBayarClaim,
                       a.validdt               TglValidClaim,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       k.createdt              TglRejectClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	   Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-06'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       d.paidamt               JmlBayarClaim,
                       a.validdt               TglValidClaim,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       k.createdt              TglRejectClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	   Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-06'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglPengajuan,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLapor,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       d.paidamt               JmlBayarClaim,
                       a.validdt               TglValidClaim,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       k.createdt              TglRejectClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	   Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-06'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-06'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-06'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-07-01'	and '2020-10-09' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-07-01'	and '2020-10-09' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-07-01'	and '2020-10-09' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-07-01'	and '2020-10-09' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-10-14' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-29' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-02-29'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-02-29'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       o.msdesc                JenisKelamin,
                       p.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'JKEL') o
                              ON o.msid  = tr.jkel
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') p
                              ON p.msid  = tr.pekerjaan
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       o.msdesc                JenisKelamin,
                       p.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'JKEL') o
                              ON o.msid  = a.jkel
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') p
                              ON p.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       o.msdesc                JenisKelamin,
                       p.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'JKEL') o
                              ON o.msid  = a.jkel
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') p
                              ON p.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-04'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '1-01-20-0-' AND '1-09-20-0-'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '1-01-20-0-' AND '1-09-20-0-'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '1-01-20-0-' AND '1-09-20-0-'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '1-01-20-0-' AND '1-09-20-0-'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '1-01-20-0-' AND '1-09-20-0-'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '1-01-20-0-' AND '1-09-20-0-'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-09'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-11-09' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt jmlbayar,a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       Concat('`', a.policyno) 'No Sertifikat',
                       a.nopeserta             'No Pinjaman',
                       a.nama Nama              Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                tgllahir 'Tgl Lahir',
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    'No KTP',
                       akhir                   Tglakhir Akhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              'Tgl Input',
                       e.paiddt                'Tgl Bayar Premi',
                       e.paidamt               'Jml Bayar Premi',
                       Concat('`', h.regclaim) 'No Claim',
                       h.tglkejadian           'Tgl Kejadian',
                       h.tgllapor              'Tgl Lapor Claim',
                       h.nilaios               'Nilai OS',
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                       a.validdt               'Tgl Validasi',
                       h.validdt               'Tgl Valid Claim',
                       k.createdt              'Tgl Reject Claim',
                       n.msdesc                'Alasan Reject',
                       h.comment               Keterangan,
                       j.createdt              'Tgl Terima Dokumen',
                       d.paiddt                'Tgl Bayar Claim',
                       d.paidamt               'Jml Bayar Claim',
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   'Status Dokumen',
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       Concat('`', a.policyno) 'No Sertifikat',
                       a.nopeserta             'No Pinjaman',
                       a.nama Nama              Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                tgllahir 'Tgl Lahir',
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    'No KTP',
                       akhir                   Tglakhir Akhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              'Tgl Input',
                       e.paiddt                'Tgl Bayar Premi',
                       e.paidamt               'Jml Bayar Premi',
                       Concat('`', h.regclaim) 'No Claim',
                       h.tglkejadian           'Tgl Kejadian',
                       h.tgllapor              'Tgl Lapor Claim',
                       h.nilaios               'Nilai OS',
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                       a.validdt               'Tgl Validasi',
                       h.validdt               'Tgl Valid Claim',
                       k.createdt              'Tgl Reject Claim',
                       n.msdesc                'Alasan Reject',
                       h.comment               Keterangan,
                       j.createdt              'Tgl Terima Dokumen',
                       d.paiddt                'Tgl Bayar Claim',
                       d.paidamt               'Jml Bayar Claim',
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   'Status Dokumen',
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-09'  select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       Concat('`', a.policyno) 'No Sertifikat',
                       a.nopeserta             'No Pinjaman',
                       a.nama Nama              Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                tgllahir 'Tgl Lahir',
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    'No KTP',
                       akhir                   Tglakhir Akhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              'Tgl Input',
                       e.paiddt                'Tgl Bayar Premi',
                       e.paidamt               'Jml Bayar Premi',
                       Concat('`', h.regclaim) 'No Claim',
                       h.tglkejadian           'Tgl Kejadian',
                       h.tgllapor              'Tgl Lapor Claim',
                       h.nilaios               'Nilai OS',
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                       a.validdt               'Tgl Validasi',
                       h.validdt               'Tgl Valid Claim',
                       k.createdt              'Tgl Reject Claim',
                       n.msdesc                'Alasan Reject',
                       h.comment               Keterangan,
                       j.createdt              'Tgl Terima Dokumen',
                       d.paiddt                'Tgl Bayar Claim',
                       d.paidamt               'Jml Bayar Claim',
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   'Status Dokumen',
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-09'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       Concat('`', a.policyno) 'No Sertifikat',
                       a.nopeserta             'No Pinjaman',
                       a.nama Nama              Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                tgllahir 'Tgl Lahir',
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    'No KTP',
                       akhir                   Tglakhir Akhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              'Tgl Input',
                       e.paiddt                'Tgl Bayar Premi',
                       e.paidamt               'Jml Bayar Premi',
                       Concat('`', h.regclaim) 'No Claim',
                       h.tglkejadian           'Tgl Kejadian',
                       h.tgllapor              'Tgl Lapor Claim',
                       h.nilaios               'Nilai OS',
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                       a.validdt               'Tgl Validasi',
                       h.validdt               'Tgl Valid Claim',
                       k.createdt              'Tgl Reject Claim',
                       n.msdesc                'Alasan Reject',
                       h.comment               Keterangan,
                       j.createdt              'Tgl Terima Dokumen',
                       d.paiddt                'Tgl Bayar Claim',
                       d.paidamt               'Jml Bayar Claim',
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   'Status Dokumen',
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-09'  select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2019-07-01'	and '2020-11-09' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-11-09' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2019-07-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2019-11-09'	and '2020-11-09'  and  a.asuransi =  'ETI'select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai,akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,  g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input'a,a.nopeserta 'No Pinjaman',REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-05-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2019-11-09'	and '2020-11-09'  and  a.asuransi =  'TKP'select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa, a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2020-05-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2020-05-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2020-05-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,a.up,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2020-05-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai,a.akhir Akhir,a.masa,a.tunggakan Graceperiod,up UP,  tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',concat('`',a.policyno) 'No Sertifikat',a.validdt 'Tgl Validasi'  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-05-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, a.akhir Akhir,a.masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',  a.createdt 'Tgl Input',a.validdt 'Tgl Validasi',concat('`',a.policyno) 'No Sertifikat',h.tglbatal 'Tgl Batal' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2020-05-01'	and '2020-05-31' SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    'No Register',
                      a.nopeserta             'No Pinjaman',
                      a.nama                  Nama,
                      Concat('`', a.noktp)    'No KTP',
                      jkel                    Jkel,
                      pekerjaan               Pekerjaan,
                      b.msdesc                Cabang,
                      tgllahir                'Tgl Lahir',
                      mulai                   Mulai,
                      a.akhir                 Akhir,
                      a.masa                  Masa,
                      a.tunggakan             Graceperiod,
                      up                      UP,
                      tpremi                  Premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'Status',
                      a.createdt              'Tgl Input',
                      a.validdt               'Tgl Validasi',
                      Concat('`', a.policyno) 'No Sertifikat',
                      e.paiddt                'Tgl Bayar Premi',
                      e.paidamt               'Jml Bayar Premi',
                      h.tglbatal              'Tgl Batal',
                      h.sisa                  'Sisa',
                      d.paiddt                'Tgl Refund Dibayar',
                      h.refund                'Jml Refund Dibayar'
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2020-05-01' AND '2020-05-31'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       Concat('`', a.policyno) 'No Sertifikat',
                       a.nopeserta             'No Pinjaman',
                       a.nama Nama              Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                tgllahir 'Tgl Lahir',
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    'No KTP',
                       akhir                   Tglakhir Akhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              'Tgl Input',
                       e.paiddt                'Tgl Bayar Premi',
                       e.paidamt               'Jml Bayar Premi',
                       Concat('`', h.regclaim) 'No Claim',
                       h.tglkejadian           'Tgl Kejadian',
                       h.tgllapor              'Tgl Lapor Claim',
                       h.nilaios               'Nilai OS',
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                       a.validdt               'Tgl Validasi',
                       h.validdt               'Tgl Valid Claim',
                       k.createdt              'Tgl Reject Claim',
                       n.msdesc                'Alasan Reject',
                       h.comment               Keterangan,
                       j.createdt              'Tgl Terima Dokumen',
                       d.paiddt                'Tgl Bayar Claim',
                       d.paidamt               'Jml Bayar Claim',
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   'Status Dokumen',
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-05-01' AND '2020-05-31'  select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-05-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-04-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc Mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2020-04-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-04-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-04-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-04-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-05-31' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai,akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,  g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.nopeserta 'No Pinjaman',REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa, a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,a.up,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai,a.akhir Akhir,a.masa,a.tunggakan Graceperiod,up UP,  tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',concat('`',a.policyno) 'No Sertifikat',a.validdt 'Tgl Validasi'  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, a.akhir Akhir,a.masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',  a.createdt 'Tgl Input',a.validdt 'Tgl Validasi',concat('`',a.policyno) 'No Sertifikat',h.tglbatal 'Tgl Batal' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2020-04-01'	and '2020-04-30' SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    'No Register',
                      a.nopeserta             'No Pinjaman',
                      a.nama                  Nama,
                      Concat('`', a.noktp)    'No KTP',
                      jkel                    Jkel,
                      pekerjaan               Pekerjaan,
                      b.msdesc                Cabang,
                      tgllahir                'Tgl Lahir',
                      mulai                   Mulai,
                      a.akhir                 Akhir,
                      a.masa                  Masa,
                      a.tunggakan             Graceperiod,
                      up                      UP,
                      tpremi                  Premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'Status',
                      a.createdt              'Tgl Input',
                      a.validdt               'Tgl Validasi',
                      Concat('`', a.policyno) 'No Sertifikat',
                      e.paiddt                'Tgl Bayar Premi',
                      e.paidamt               'Jml Bayar Premi',
                      h.tglbatal              'Tgl Batal',
                      h.sisa                  'Sisa',
                      d.paiddt                'Tgl Refund Dibayar',
                      h.refund                'Jml Refund Dibayar'
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2020-04-01' AND '2020-04-30'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       Concat('`', a.policyno) 'No Sertifikat',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    'No KTP',
                       akhir                   Tglakhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              'Tgl Input',
                       e.paiddt                'Tgl Bayar Premi',
                       e.paidamt               'Jml Bayar Premi',
                       Concat('`', h.regclaim) 'No Claim',
                       h.tglkejadian           'Tgl Kejadian',
                       h.tgllapor              'Tgl Lapor Claim',
                       h.nilaios               'Nilai OS',
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                       a.validdt               'Tgl Validasi',
                       h.validdt               'Tgl Valid Claim',
                       k.createdt              'Tgl Reject Claim',
                       n.msdesc                'Alasan Reject',
                       h.comment               Keterangan,
                       j.createdt              'Tgl Terima Dokumen',
                       d.paiddt                'Tgl Bayar Claim',
                       d.paidamt               'Jml Bayar Claim',
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   'Status Dokumen',
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-04-01' AND '2020-04-30'  select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-04-30' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-11-09' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-11-09' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2019-01-01'	and '2020-11-10' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc Mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-01-01'	and '2020-11-10' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2019-01-01'	and '2020-11-10' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-11-10' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-01-01'	and '2020-11-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-11-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.policyno 'No Sertifikat' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-02-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-02-01' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       Concat('`', a.policyno) 'No Sertifikat',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    'No KTP',
                       akhir                   Tglakhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              'Tgl Input',
                       e.paiddt                'Tgl Bayar Premi',
                       e.paidamt               'Jml Bayar Premi',
                       Concat('`', h.regclaim) 'No Claim',
                       h.tglkejadian           'Tgl Kejadian',
                       h.tgllapor              'Tgl Lapor Claim',
                       h.nilaios               'Nilai OS',
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                       a.validdt               'Tgl Validasi',
                       h.validdt               'Tgl Valid Claim',
                       k.createdt              'Tgl Reject Claim',
                       n.msdesc                'Alasan Reject',
                       h.comment               Keterangan,
                       j.createdt              'Tgl Terima Dokumen',
                       d.paiddt                'Tgl Bayar Claim',
                       d.paidamt               'Jml Bayar Claim',
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   'Status Dokumen',
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-03-01'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       Concat('`', a.policyno) 'No Sertifikat',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    'No KTP',
                       akhir                   Tglakhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              'Tgl Input',
                       e.paiddt                'Tgl Bayar Premi',
                       e.paidamt               'Jml Bayar Premi',
                       Concat('`', h.regclaim) 'No Claim',
                       h.tglkejadian           'Tgl Kejadian',
                       h.tgllapor              'Tgl Lapor Claim',
                       h.nilaios               'Nilai OS',
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                       a.validdt               'Tgl Validasi',
                       h.validdt               'Tgl Valid Claim',
                       k.createdt              'Tgl Reject Claim',
                       n.msdesc                'Alasan Reject',
                       h.comment               Keterangan,
                       j.createdt              'Tgl Terima Dokumen',
                       d.paiddt                'Tgl Bayar Claim',
                       d.paidamt               'Jml Bayar Claim',
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   'Status Dokumen',
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-20'  SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    'No Register',
                      a.nopeserta             'No Pinjaman',
                      a.nama                  Nama,
                      Concat('`', a.noktp)    'No KTP',
                      jkel                    Jkel,
                      pekerjaan               Pekerjaan,
                      b.msdesc                Cabang,
                      tgllahir                'Tgl Lahir',
                      mulai                   Mulai,
                      a.akhir                 Akhir,
                      a.masa                  Masa,
                      a.tunggakan             Graceperiod,
                      up                      UP,
                      tpremi                  Premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'Status',
                      a.createdt              'Tgl Input',
                      a.validdt               'Tgl Validasi',
                      Concat('`', a.policyno) 'No Sertifikat',
                      e.paiddt                'Tgl Bayar Premi',
                      e.paidamt               'Jml Bayar Premi',
                      h.tglbatal              'Tgl Batal',
                      h.sisa                  'Sisa',
                      d.paiddt                'Tgl Refund Dibayar',
                      h.refund                'Jml Refund Dibayar'
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2020-01-01' AND '2020-11-20'select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2020-01-01'	and '2020-11-20' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-01-01'	and '2020-01-01' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input' from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-01-01'	and '2020-01-31' SELECT
                  f.msdesc                  Produk,
                  concat('`', a.regid)      'No Register',
                  a.nopeserta               'No Pinjaman',
                  a.nama                    Nama,
                  h.nama                    'Nama AO',
                  h.username                'Username AO',
                  concat('`', a.noktp)      'No KTP',
                  jkel                      Jkel,
                  pekerjaan                 Pekerjaan,
                  b.msdesc                  Cabang,
                  tgllahir                  'Tgl Lahir',
                  mulai                     Mulai,
                  akhir                     Akhir,
                  masa                      Masa,
                  a.tunggakan               Graceperiod,
                  up                        UP,
                  tpremi                    Premi,
                  g.msdesc                  Asuransi,
                  c.msdesc                  Status,
                  a.createdt                'Tgl Input' 
                FROM
                  tr_sppa a 
                  LEFT JOIN ms_master b 
                    ON a.cabang = b.msid 
                    AND b.mstype = 'cab' 
                  LEFT JOIN ms_master c 
                    ON a.status = c.msid 
                    AND c.mstype = 'streq' 
                  LEFT JOIN ms_master f 
                    ON a.produk = f.msid 
                    AND f.mstype = 'produk' 
                  LEFT JOIN ms_master g 
                    ON a.asuransi = g.msid 
                    AND g.mstype = 'asuransi' 
                  LEFT JOIN ms_admin h
                    ON a.createby = h.username
                WHERE
                  a.status IN ('0', '1')
                  AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-31' SELECT
                  f.msdesc                  Produk,
                  concat('`', a.regid)      'No Register',
                  a.nopeserta               'No Pinjaman',
                  a.nama                    Nama,
                  i.nama                    'Nama AO',
                  i.username                'Username AO',
                  concat('`', a.noktp)      'No KTP',
                  jkel                      Jkel,
                  h.msdesc                  Pekerjaan,
                  b.msdesc                  Cabang,
                  tgllahir                  'Tgl Lahir',
                  mulai                     Mulai,
                  akhir                     Akhir,
                  masa                      Masa,
                  a.tunggakan               Graceperiod,
                  up                        UP,
                  tpremi                    Premi,
                  g.msdesc                  Asuransi,
                  c.msdesc                  Status,
                  a.createdt                'Tgl Input' 
                FROM
                  tr_sppa a 
                  LEFT JOIN ms_master b 
                    ON a.cabang = b.msid 
                    AND b.mstype = 'cab' 
                  LEFT JOIN ms_master c 
                    ON a.status = c.msid 
                    AND c.mstype = 'streq' 
                  LEFT JOIN ms_master f 
                    ON a.produk = f.msid 
                    AND f.mstype = 'produk' 
                  LEFT JOIN ms_master g 
                    ON a.asuransi = g.msid 
                    AND g.mstype = 'asuransi' 
                  LEFT JOIN ms_master h 
                    ON a.asuransi = h.msid 
                    AND h.mstype = 'KERJA' 
                  LEFT JOIN ms_admin i
                    ON a.createby = i.username
                WHERE
                  a.status IN ('0', '1')
                  AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-31' SELECT
                  f.msdesc                  Produk,
                  concat('`', a.regid)      'No Register',
                  a.nopeserta               'No Pinjaman',
                  a.nama                    Nama,
                  i.nama                    'Nama AO',
                  i.username                'Username AO',
                  concat('`', a.noktp)      'No KTP',
                  jkel                      Jkel,
                  h.msdesc                  Pekerjaan,
                  b.msdesc                  Cabang,
                  tgllahir                  'Tgl Lahir',
                  mulai                     Mulai,
                  akhir                     Akhir,
                  masa                      Masa,
                  a.tunggakan               Graceperiod,
                  up                        UP,
                  tpremi                    Premi,
                  g.msdesc                  Asuransi,
                  c.msdesc                  Status,
                  a.createdt                'Tgl Input' 
                FROM
                  tr_sppa a 
                  LEFT JOIN ms_master b 
                    ON a.cabang = b.msid 
                    AND b.mstype = 'cab' 
                  LEFT JOIN ms_master c 
                    ON a.status = c.msid 
                    AND c.mstype = 'streq' 
                  LEFT JOIN ms_master f 
                    ON a.produk = f.msid 
                    AND f.mstype = 'produk' 
                  LEFT JOIN ms_master g 
                    ON a.asuransi = g.msid 
                    AND g.mstype = 'asuransi' 
                  LEFT JOIN ms_master h 
                    ON a.pekerjaan = h.msid 
                    AND h.mstype = 'KERJA' 
                  LEFT JOIN ms_admin i
                    ON a.createby = i.username
                WHERE
                  a.status IN ('0', '1')
                  AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-31' SELECT
                  f.msdesc                                  Produk,
                  concat('`', a.regid)                      'No Register',
                  a.nopeserta                               'No Pinjaman',
                  a.nama                                    Nama,
                  i.nama                                    'Nama AO',
                  i.username                                'Username AO',
                  concat('`', a.noktp)                      'No KTP',
                  jkel                                      Jkel,
                  IF(h.msdesc IS NULL,pekerjaan,h.msdesc)   Pekerjaan,
                  b.msdesc                                  Cabang,
                  tgllahir                                  'Tgl Lahir',
                  mulai                                     Mulai,
                  akhir                                     Akhir,
                  masa                                      Masa,
                  a.tunggakan                               Graceperiod,
                  up                                        UP,
                  tpremi                                    Premi,
                  g.msdesc                                  Asuransi,
                  c.msdesc                                  Status,
                  a.createdt                                'Tgl Input' 
                FROM
                  tr_sppa a 
                  LEFT JOIN ms_master b 
                    ON a.cabang = b.msid 
                    AND b.mstype = 'cab' 
                  LEFT JOIN ms_master c 
                    ON a.status = c.msid 
                    AND c.mstype = 'streq' 
                  LEFT JOIN ms_master f 
                    ON a.produk = f.msid 
                    AND f.mstype = 'produk' 
                  LEFT JOIN ms_master g 
                    ON a.asuransi = g.msid 
                    AND g.mstype = 'asuransi' 
                  LEFT JOIN ms_master h 
                    ON a.pekerjaan = h.msid 
                    AND h.mstype = 'KERJA' 
                  LEFT JOIN ms_admin i
                    ON a.createby = i.username
                WHERE
                  a.status IN ('0', '1')
                  AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-15' SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(h.msdesc IS NULL, pekerjaan, h.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       akhir                                     Akhir,
                       masa                                      Masa,
                       a.tunggakan                               Graceperiod,
                       up                                        UP,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       i.nama                                    'Nama AO',
                       i.username                                'Username AO',
                       a.createdt                                'Tgl Input'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status IN ( '11' )
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-15'SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(h.msdesc IS NULL, pekerjaan, h.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       akhir                                     Akhir,
                       masa                                      Masa,
                       a.tunggakan                               Graceperiod,
                       up                                        UP,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       i.nama                                    'Nama AO',
                       i.username                                'Username AO',
                       a.createdt                                'Tgl Input'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status IN ( '2' )
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-15'SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(h.msdesc IS NULL, pekerjaan, h.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       akhir                                     Akhir,
                       masa                                      Masa,
                       a.tunggakan                               Graceperiod,
                       up                                        UP,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       i.nama                                    'Nama AO',
                       i.username                                'Username AO',
                       a.createdt                                'Tgl Input'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status IN ( '3' )
                       AND LEFT(a.mulai, 10) BETWEEN '2020-01-01' AND '2020-01-15'SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(h.msdesc IS NULL, pekerjaan, h.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       akhir                                     Akhir,
                       masa                                      Masa,
                       a.tunggakan                               Graceperiod,
                       a.up,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       i.nama                                    'Nama AO',
                       i.username                                'Username AO',
                       a.createdt                                'Tgl Input'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status IN ( '4' )
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-15'SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(h.msdesc IS NULL, pekerjaan, h.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       akhir                                     Akhir,
                       masa                                      Masa,
                       a.tunggakan                               Graceperiod,
                       a.up,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       i.nama                                    'Nama AO',
                       i.username                                'Username AO',
                       a.createdt                                'Tgl Input'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status IN ( '4' )
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-02-29'SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(h.msdesc IS NULL, pekerjaan, h.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       a.akhir                                   Akhir,
                       a.masa,
                       a.tunggakan                               Graceperiod,
                       up                                        UP,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       i.nama                                    'Nama AO',
                       i.username                                'Username AO',
                       a.createdt                                'Tgl Input',
                       Concat('`', a.policyno)                   'No Sertifikat',
                       a.validdt                                 'Tgl Validasi'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status IN ( '5' )
                       AND LEFT(a.validdt, 10) BETWEEN '2020-01-01' AND '2020-02-29'SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(i.msdesc IS NULL, pekerjaan, i.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       a.akhir                                   Akhir,
                       a.masa,
                       a.tunggakan                               Graceperiod,
                       up                                        UP,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  Status,
                       d.paiddt                                  'Tgl Bayar',
                       j.nama                                    'Nama AO',
                       j.username                                'Username AO',
                       a.createdt                                'Tgl Input',
                       a.validdt                                 'Tgl Validasi',
                       Concat('`', a.policyno)                   'No Sertifikat',
                       h.tglbatal                                'Tgl Batal'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid
                                 AND d.paidtype = 'PREMI'
                       LEFT JOIN tr_sppa_cancel h
                              ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON a.pekerjaan = i.msid
                                 AND i.mstype = 'KERJA'
                       LEFT JOIN ms_admin j
                              ON a.createby = j.username
                WHERE  a.status IN ( '7', '71', '72', '73' )
                       AND LEFT(h.tglbatal, 10) BETWEEN '2020-01-01' AND '2020-02-29'SELECT f.msdesc                                  Produk,
                       Concat('`', a.regid)                      'No Register',
                       a.nopeserta                               'No Pinjaman',
                       a.nama                                    Nama,
                       Concat('`', a.noktp)                      'No KTP',
                       jkel                                      Jkel,
                       If(i.msdesc IS NULL, pekerjaan, i.msdesc) Pekerjaan,
                       b.msdesc                                  Cabang,
                       tgllahir                                  'Tgl Lahir',
                       mulai                                     Mulai,
                       a.akhir                                   Akhir,
                       a.masa                                    Masa,
                       a.tunggakan                               Graceperiod,
                       up                                        UP,
                       tpremi                                    Premi,
                       g.msdesc                                  Asuransi,
                       c.msdesc                                  'Status',
                       j.nama                                    'Nama AO',
                       j.username                                'Username AO',
                       a.createdt                                'Tgl Input',
                       a.validdt                                 'Tgl Validasi',
                       Concat('`', a.policyno)                   'No Sertifikat',
                       e.paiddt                                  'Tgl Bayar Premi',
                       e.paidamt                                 'Jml Bayar Premi',
                       h.tglbatal                                'Tgl Batal',
                       h.sisa                                    'Sisa',
                       d.paiddt                                  'Tgl Refund Dibayar',
                       h.refund                                  'Jml Refund Dibayar'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid
                                 AND d.paidtype = 'REFUND'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid
                                 AND e.paidtype = 'premi'
                       LEFT JOIN tr_sppa_cancel h
                              ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON a.pekerjaan = i.msid
                                 AND i.mstype = 'KERJA'
                       LEFT JOIN ms_admin j
                              ON a.createby = j.username
                WHERE  a.status IN ( '8', '81', '82', '83', '84', '85' )
                       AND LEFT(h.tglbatal, 10) BETWEEN '2020-01-01' AND '2020-02-29'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       Concat('`', a.policyno) 'No Sertifikat',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    'No KTP',
                       akhir                   Tglakhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       p.nama                  'Nama AO',
                       p.username              'Username AO',
                       a.createdt              'Tgl Input',
                       e.paiddt                'Tgl Bayar Premi',
                       e.paidamt               'Jml Bayar Premi',
                       Concat('`', h.regclaim) 'No Claim',
                       h.tglkejadian           'Tgl Kejadian',
                       h.tgllapor              'Tgl Lapor Claim',
                       h.nilaios               'Nilai OS',
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) 'Tgl Jatuh Tempo',
                       a.validdt               'Tgl Validasi',
                       h.validdt               'Tgl Valid Claim',
                       k.createdt              'Tgl Reject Claim',
                       n.msdesc                'Alasan Reject',
                       h.comment               Keterangan,
                       j.createdt              'Tgl Terima Dokumen',
                       d.paiddt                'Tgl Bayar Claim',
                       d.paidamt               'Jml Bayar Claim',
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   'Status Dokumen',
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_admin p
                              ON a.createby = p.username
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-02-29'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       e.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       i.nama                  'Nama AO',
                       i.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       INNER JOIN ms_master e
                               ON a.pekerjaan  = e.msid
                                  AND e.mstype = 'KERJA'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-02-29'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       e.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       i.nama                  'Nama AO',
                       i.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       INNER JOIN ms_master e
                               ON a.pekerjaan  = e.msid
                                  AND e.mstype = 'KERJA'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       e.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       i.nama                  'Nama AO',
                       i.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       INNER JOIN ms_master e
                               ON a.pekerjaan  = e.msid
                                  AND e.mstype = 'KERJA'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       e.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       i.nama                  'Nama AO',
                       i.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa a
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'cab') b
                               ON a.cabang = b.msid
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'streq') c
                               ON a.status = c.msid
                       INNER JOIN (SELECT paiddt,paidamt FROM tr_sppa_paid WHERE paidtype = 'PREMI') d
                               ON d.regid = a.regid
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'KERJA') e
                               ON a.pekerjaan  = e.msid
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'PRODUK') f
                               ON a.produk = f.msid
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'ASURANSI') g
                               ON a.asuransi = g.msid
                       LEFT JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'mitra') h
                              ON a.mitra = h.msid
                       LEFT JOIN ms_admin i
                              ON a.createby = i.username
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa a
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'cab') b
                               ON a.cabang = b.msid
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'streq') c
                               ON a.status = c.msid
                       INNER JOIN (SELECT paiddt,paidamt FROM tr_sppa_paid WHERE paidtype = 'PREMI') d
                               ON d.regid = a.regid
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'PRODUK') f
                               ON a.produk = f.msid
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'ASURANSI') g
                               ON a.asuransi = g.msid
                       LEFT JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'mitra') h
                              ON a.mitra = h.msid
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa a
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'cab') b
                               ON a.cabang = b.msid
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'streq') c
                               ON a.status = c.msid
                       INNER JOIN (SELECT regid,paiddt,paidamt FROM tr_sppa_paid WHERE paidtype = 'PREMI') d
                               ON d.regid = a.regid
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'PRODUK') f
                               ON a.produk = f.msid
                       INNER JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'ASURANSI') g
                               ON a.asuransi = g.msid
                       LEFT JOIN (SELECT msid,msdesc FROM ms_master WHERE mstype = 'mitra') h
                              ON a.mitra = h.msid
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar',d.paidamt 'Jml Bayar',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat',h.msdesc Mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2020-01-01'	and '2020-01-02' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa_paid a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       INNER JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa_paid a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       INNER JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                Mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                WHERE  a.status = '20'
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02' SELECT f.msdesc             Produk,
                       Concat('`', a.regid) 'No Register',
                       a.nopeserta          'No Pinjaman',
                       a.nama               Nama,
                       Concat('`', a.noktp) 'No KTP',
                       jkel                 Jkel,
                       d.msdesc             Pekerjaan,
                       b.msdesc             Cabang,
                       tgllahir             'Tgl Lahir',
                       mulai                Mulai,
                       akhir                Akhir,
                       masa                 Masa,
                       a.tunggakan          Graceperiod,
                       up                   UP,
                       tpremi               Premi,
                       g.msdesc             Asuransi,
                       c.msdesc             Status,
                       e.nama               'Nama AO',
                       e.username           'Username AO',
                       a.createdt           'Tgl Input',
                       a.policyno           'No Sertifikat'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master d
                              ON a.status = d.msid
                                 AND d.mstype = 'KERJA'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                WHERE  a.status IN ( 2, 3, 4, 5 )
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02' SELECT f.msdesc             Produk,
                       Concat('`', a.regid) 'No Register',
                       a.nopeserta          'No Pinjaman',
                       a.nama               Nama,
                       Concat('`', a.noktp) 'No KTP',
                       jkel                 Jkel,
                       d.msdesc             Pekerjaan,
                       b.msdesc             Cabang,
                       tgllahir             'Tgl Lahir',
                       mulai                Mulai,
                       akhir                Akhir,
                       masa                 Masa,
                       a.tunggakan          Graceperiod,
                       up                   UP,
                       tpremi               Premi,
                       g.msdesc             Asuransi,
                       c.msdesc             Status,
                       e.nama               'Nama AO',
                       e.username           'Username AO',
                       a.createdt           'Tgl Input',
                       a.policyno           'No Sertifikat'
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master d
                              ON a.pekerjaan = d.msid
                                 AND d.mstype = 'KERJA'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                WHERE  a.status IN ( 2, 3, 4, 5 )
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       d.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       LEFT JOIN ms_master d
                              ON a.pekerjaan = d.msid
                                 AND d.mstype = 'KERJA'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                WHERE  LEFT(d.paiddt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       -- d.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       /* LEFT JOIN ms_master d
                              ON a.pekerjaan = d.msid
                                 AND d.mstype = 'KERJA'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username */
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                WHERE  LEFT(d.paiddt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       -- d.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       /* LEFT JOIN ms_master d
                              ON a.pekerjaan = d.msid
                                 AND d.mstype = 'KERJA'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username */
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                WHERE  LEFT(d.paiddt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       /* d.msdesc                Pekerjaan, */
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       /* LEFT JOIN ms_master d
                              ON a.pekerjaan = d.msid
                                 AND d.mstype = 'KERJA'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username */
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                WHERE  LEFT(d.paiddt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       /* d.msdesc                Pekerjaan, */
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       /* e.nama                  'Nama AO',
                       e.username              'Username AO', */
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       /* LEFT JOIN ms_master d
                              ON a.pekerjaan = d.msid
                                 AND d.mstype = 'KERJA'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username */
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                WHERE  LEFT(d.paiddt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       /* d.msdesc                Pekerjaan, */
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       /* e.nama                  'Nama AO',
                       e.username              'Username AO', */
                       d.paiddt                'Tgl Bayar',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat',
                       h.msdesc                mitra
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       INNER JOIN tr_sppa_paid d
                               ON d.regid = a.regid
                                  AND d.paidtype = 'PREMI'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid
                                  AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.mitra = h.msid
                                 AND h.mstype = 'mitra'
                       LEFT JOIN ms_master i
                              ON a.pekerjaan = i.msid
                                 AND i.mstype = 'KERJA'
                WHERE  LEFT(d.paiddt, 10) BETWEEN '2020-01-01' AND '2020-01-02'select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-01-02' select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nopeserta 'No Pinjaman',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai, akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,g.msdesc Asuransi,c.msdesc Status,d.paiddt 'Tgl Bayar Premi',d.paidamt 'Jml Bayar Premi',a.createdt 'Tgl Input',  concat('`',a.policyno) 'No Sertifikat'  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-01-02' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       h.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar Premi',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid
                                 AND d.paidtype = 'PREMI'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                WHERE  LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'select f.msdesc Produk,concat('`',a.regid) 'No Register',a.nama Nama,concat('`',a.noktp) 'No KTP', jkel Jkel,pekerjaan Pekerjaan,b.msdesc Cabang,tgllahir 'Tgl Lahir',mulai Mulai,akhir Akhir,masa Masa,a.tunggakan Graceperiod,up UP,tpremi Premi,  g.msdesc Asuransi,c.msdesc Status,a.createdt 'Tgl Input',a.nopeserta 'No Pinjaman',REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-01-02' SELECT f.msdesc             Produk,
                       Concat('`', a.regid) 'No Register',
                       a.nama               Nama,
                       Concat('`', a.noktp) 'No KTP',
                       jkel                 Jkel,
                       d.msdesc             Pekerjaan,
                       b.msdesc             Cabang,
                       tgllahir             'Tgl Lahir',
                       mulai                Mulai,
                       akhir                Akhir,
                       masa                 Masa,
                       a.tunggakan          Graceperiod,
                       up                   UP,
                       tpremi               Premi,
                       g.msdesc             Asuransi,
                       c.msdesc             Status,
                       e.nama               'Nama AO',
                       e.username           'Username AO',
                       a.createdt           'Tgl Input',
                       a.nopeserta          'No Pinjaman',
                       Replace(Replace(Replace(Concat(h.comment, ' ', a.comment), '
', ''),
                               '	', ''),
                       '', '')            Ket
                FROM   tr_sppa a
                       LEFT JOIN ms_master b
                              ON a.cabang = b.msid
                                 AND b.mstype = 'cab'
                       LEFT JOIN ms_master c
                              ON a.status = c.msid
                                 AND c.mstype = 'streq'
                       LEFT JOIN ms_master d
                              ON a.pekerjaan = d.msid
                                 AND d.mstype = 'KERJA'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       LEFT JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN tr_sppa_log h
                              ON a.regid = h.regid
                                 AND h.status = '12'
                WHERE  a.status IN ( '12' )
                       AND LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    'No Register',
                       a.nopeserta             'No Pinjaman',
                       a.nama                  Nama,
                       Concat('`', a.noktp)    'No KTP',
                       jkel                    Jkel,
                       h.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                'Tgl Lahir',
                       mulai                   Mulai,
                       akhir                   Akhir,
                       masa                    Masa,
                       a.tunggakan             Graceperiod,
                       up                      UP,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                Status,
                       e.nama                  'Nama AO',
                       e.username              'Username AO',
                       d.paiddt                'Tgl Bayar Premi',
                       d.paidamt               'Jml Bayar Premi',
                       a.createdt              'Tgl Input',
                       Concat('`', a.policyno) 'No Sertifikat'
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid
                                  AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid
                                  AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid
                                 AND d.paidtype = 'PREMI'
                       LEFT JOIN ms_admin e
                              ON a.createby = e.username
                       INNER JOIN ms_master f
                               ON a.produk = f.msid
                                  AND f.mstype = 'produk'
                       LEFT JOIN ms_master g
                              ON a.asuransi = g.msid
                                 AND g.mstype = 'asuransi'
                       LEFT JOIN ms_master h
                              ON a.pekerjaan = h.msid
                                 AND h.mstype = 'KERJA'
                WHERE  LEFT(a.createdt, 10) BETWEEN '2020-01-01' AND '2020-01-02'