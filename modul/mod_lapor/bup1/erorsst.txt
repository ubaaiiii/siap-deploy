SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-06'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-06'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2019-01-01'	and '2020-09-30' SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    Noregister,
                      a.nopeserta             Nopinjaman,
                      a.nama,
                      Concat('`', a.noktp)    noktp,
                      jkel,
                      pekerjaan,
                      b.msdesc                cabang,
                      tgllahir,
                      mulai,
                      a.akhir,
                      a.masa,
                      a.tunggakan             graceperiod,
                      up,
                      tpremi                  premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'status',
                      a.createdt              tglinput,
                      a.validdt               tglvalidasi,
                      Concat('`', a.policyno) nosertifikat,
                      e.paiddt                tglbayarpremi,
                      e.paidamt               JmlbayarPremi,
                      h.tglbatal,
                      h.sisa,
                      d.paiddt                tglrefundbayar,
                      h.refund                refundbayar
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2019-01-01' AND '2020-09-30'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-01-01' AND '2020-09-30'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-07'   AND  a.cabang='8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-07'   AND  a.cabang='8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-08'   AND  a.cabang='8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-06-01' AND '2020-10-08'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-08'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2018-10-07'	and '--'  and  a.cabang =  '21'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2018-10-07'	and '2020-10-08'  and  a.cabang =  '21'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2018-10-07'	and '2020-10-08'  and  a.cabang =  '21'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2018-10-07'	and '2020-10-08'  and  a.cabang =  '21'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '--'	and '--'  and  a.cabang =  '21'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-08'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-09-01'	and '020-9/-0/' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-09-01'	and '020-9/-0/' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-07-01'	and '2020-07-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-08'  and  a.cabang = '49' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FIRMAN5946' or a.parent='FIRMAN5946')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-08'  and  a.cabang = '49' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FIRMAN5946' or a.parent='FIRMAN5946')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-04-03'	and '2020-10-08'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GIANKE1143' or a.parent='GIANKE1143')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '25' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '--'	and '--'  and  a.cabang = '25'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '--'	and '--'  and  a.cabang = '25'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '--'	and '--'  and  a.cabang = '25'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-09'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '--'	and '--'  and  a.cabang = '25' and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '--'	and '--' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '--'	and '--'  and  a.cabang = '25'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-10-09'  and  a.cabang = '11'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '--'	and '--'  and  a.cabang = '11' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '--'	and '--'  and  a.cabang = '57' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GANDUN3165' or a.parent='GANDUN3165')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-06-01'	and '2020-10-09'  and  a.cabang =  '52'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-06-01'	and '2020-10-09'  and  a.cabang =  '52'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2016-01-01'	and '2020-10-09'  and  a.cabang = '57' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GANDUN3165' or a.parent='GANDUN3165')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-06-01'	and '2020-10-09'  and  a.cabang = '52'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2016-01-01'	and '2020-10-09'  and  a.cabang = '57' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GANDUN3165' or a.parent='GANDUN3165')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2016-01-01' AND '2020-10-09'   AND  a.cabang='57' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GANDUN3165' or a.parent='GANDUN3165')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2016-01-01'	and '2020-10-09'  and  a.cabang =  '57' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GANDUN3165' or a.parent='GANDUN3165')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2016-01-01'	and '2020-10-09'  and  a.cabang = '57' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GANDUN3165' or a.parent='GANDUN3165')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '--'	and '--'  and  a.produk = 'PR01'  and  a.cabang = '54' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='LUISDJ2029' or a.parent='LUISDJ2029')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '--'	and '--'  and  a.produk = 'PR01'  and  a.cabang = '54' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='LUISDJ2029' or a.parent='LUISDJ2029')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-05-31'  and  a.cabang = '35'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2015-01-01'	and '2020-10-09'  and  a.cabang = '57' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='BUDIYO7004' or a.parent='BUDIYO7004')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-10-02'  and  a.cabang = '57' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FAISAL3164' or a.parent='FAISAL3164')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '--'	and '--'  and  a.cabang =  '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '--'	and '--'  and  a.cabang = '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '--'	and '--'  and  a.cabang = '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-10-06'  and  a.cabang = '8' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GIANKE1143' or a.parent='GIANKE1143')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2017-02-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GIANKE1143' or a.parent='GIANKE1143')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2017-02-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='GIANKE1143' or a.parent='GIANKE1143')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2017-01-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='MUHAMM3048' or a.parent='MUHAMM3048')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '--'	and '--'  and  a.cabang = '34'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '8-01-20-9-'	and '8-30-20-0-'  and  a.cabang = '34'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '54'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2019-06-01'	and '2020-10-09'  and  a.cabang =  '54'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-10-09'  and  a.cabang = '54'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-10-09'  and  a.cabang = '54'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-10-09'  and  a.cabang = '54'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-10-09'  and  a.cabang = '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-09-30'  and  a.cabang = '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-09-30'  and  a.cabang = '34' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-09-30'  and  a.cabang = '34'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-06-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FEBYHU3336' or a.parent='FEBYHU3336')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-07-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FEBYHU3336' or a.parent='FEBYHU3336')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '--'	and '--'  and  a.cabang =  '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='AMIRAL6504' or a.parent='AMIRAL6504')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '--'	and '--'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='AMIRAL6504' or a.parent='AMIRAL6504')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='AMIRAL6504' or a.parent='AMIRAL6504')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '--'	and '--'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='AMIRAL6504' or a.parent='AMIRAL6504')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2016-10-31'	and '2020-10-16'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FEBYHU3336' or a.parent='FEBYHU3336')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2017-10-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='TAUFIK0499' or a.parent='TAUFIK0499')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2017-10-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='TAUFIK0499' or a.parent='TAUFIK0499'))  and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='AMIRAL6504' or a.parent='AMIRAL6504')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2018-01-01'	and '2020-10-09'  and  a.cabang = '39'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2017-02-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='TAUFIK0499' or a.parent='TAUFIK0499')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '--'	and '--'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='AMIRAL6504' or a.parent='AMIRAL6504')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2017-01-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='AMIRAL6504' or a.parent='AMIRAL6504')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2017-01-01'	and '2019-31-12'  and  a.cabang = '28'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2017-01-01'	and '2019-31-12' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2017-01-01'	and '2019-31-12' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2017-01-01'	and '2019-31-12' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '019-01-1/'	and '2019-31-12' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '019-01-1/'	and '2019-31-12' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-01-01'	and '020-9/-0/' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-07-01'	and '2020-10-09' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-07-01'	and '2020-10-09' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-07-01'	and '2020-10-09' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-07-01'	and '2020-10-09' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-01-01'	and '2020-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-07-01'	and '2020-05-31'  and  a.cabang = '32'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '019-01-1/'	and '2019-31-12' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2017-01-01'	and '2020-10-09'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUCHEO4723' or a.parent='YUCHEO4723')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-05-31'  and  a.cabang = '3'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-09-01'	and '2020-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-09-01'	and '2020-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-09-01'	and '2020-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-09-01'	and '2020-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-01-01'	and '2020-09-30' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-06-01' AND '2020-10-12'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-09-01'	and '2020-11-01'  and  a.cabang = '34'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-09-01'	and '2020-11-01'  and  a.cabang = '34'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-05-01'	and '2020-10-31'  and  a.cabang = '34'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-05-01'	and '2020-10-31'  and  a.cabang = '34'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2019-12-31'  and  a.cabang =  '32'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-12'   AND  a.cabang='8' AND  a.asuransi =  ''SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-12'   AND  a.cabang='8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2018-01-01'	and '2020-10-13'  and  a.cabang = '51'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-01-01'	and '2020-10-13'  and  a.cabang = '51'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2019-12-31'  and  a.cabang =  '51'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2019-01-01'	and '2020-10-13'  and  a.cabang = '51'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2019-01-01'	and '2020-10-13'  and  a.cabang = '49' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2020-10-13'  and  a.cabang =  '49' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2019-01-01'	and '2020-10-13'  and  a.cabang = '49' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2019-01-01'	and '2020-10-13'  and  a.cabang = '49' and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-13'  and  a.cabang = '49'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-13'  and  a.cabang = '49' and  a.asuransi =  'TKP' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='MDANAN2088' or a.parent='MDANAN2088')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-13'  and  a.cabang = '49' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='MDANAN2088' or a.parent='MDANAN2088')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-13'  and  a.cabang = '49' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='MDANAN2088' or a.parent='MDANAN2088')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-13'  and  a.cabang = '49' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='MDANAN2088' or a.parent='MDANAN2088')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-13'  and  a.cabang = '49' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='MDANAN2088' or a.parent='MDANAN2088')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-04-30'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-13'   AND  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-05-01'	and '2020-10-14'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='TAUFIK0499' or a.parent='TAUFIK0499'))  and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IRVANW5087' or a.parent='IRVANW5087')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-05-30'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IRVANW5087' or a.parent='IRVANW5087')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '--'	and '--'  and  a.cabang = '3'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '--'	and '--'  and  a.cabang = '3'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-05-30'  and  a.cabang = '3'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-10-13'  and  a.cabang = '8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-04-30'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-05-01' AND '2020-05-31'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-06-01' AND '2020-06-30'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-07-01' AND '2020-07-31'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-08-01' AND '2020-08-31'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-09-01' AND '2020-09-30'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-10-01' AND '2020-10-31'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-05-31'   AND  a.asuransi =  'ETI'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-06-01' AND '2020-06-30'   AND  a.asuransi =  'ETI'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-07-01' AND '2020-07-31'   AND  a.asuransi =  'ETI'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-08-01' AND '2020-08-31'   AND  a.asuransi =  'ETI'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-08-01' AND '2020-08-31'   AND  a.asuransi =  'ETI'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-09-01' AND '2020-09-30'   AND  a.asuransi =  'ETI'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-10-01' AND '2020-10-31'   AND  a.asuransi =  'ETI'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-06-30'   AND  a.asuransi =  'MPM'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-07-01' AND '2020-07-31'   AND  a.asuransi =  'MPM'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-08-01' AND '2020-08-31'   AND  a.asuransi =  'MPM'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-08-01' AND '2020-08-31'   AND  a.asuransi =  'MPM'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-09-01' AND '2020-09-30'   AND  a.asuransi =  'MPM'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       jkel                    JenisKelamin,
                       pekerjaan               Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(msdesc SEPARATOR ',') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-10-01' AND '2020-10-31'   AND  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-10-14'  and  a.cabang = '16'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-10-01'  and  a.cabang = '16'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-10-01'  and  a.cabang = '16'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-10-01'  and  a.cabang = '16' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128'))  and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-10-14'  and  a.cabang = '42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-10-14'  and  a.cabang = '42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-05-01'	and '2020-10-14'  and  a.cabang = '16'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-05-31'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FIRDAU5085' or a.parent='FIRDAU5085')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-05-31'  and  a.cabang = '3' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='FIRDAU5085' or a.parent='FIRDAU5085')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-14'  and  a.cabang = '4' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IWANSE2047' or a.parent='IWANSE2047')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-01-01'	and '2020-10-14'  and  a.cabang =  '4' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IWANSE2047' or a.parent='IWANSE2047')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-01-01'	and '2020-10-14'  and  a.cabang =  '4' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IWANSE2047' or a.parent='IWANSE2047')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-10-14'  and  a.cabang = '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-10-14'  and  a.cabang = '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-10-14'  and  a.produk = 'MP01'  and  a.cabang = '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-10-14'  and  a.produk = 'PR01'  and  a.cabang = '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-08-01'	and '2020-10-15'  and  a.cabang =  '4'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-08-01'	and '2020-10-15'  and  a.cabang =  '4' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IWANSE2047' or a.parent='IWANSE2047')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-08-01'	and '2020-10-15'  and  a.cabang = '4' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IWANSE2047' or a.parent='IWANSE2047')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-08-01'	and '2020-10-15'  and  a.cabang = '4' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IWANSE2047' or a.parent='IWANSE2047')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-07-01'	and '2020-10-15'  and  a.cabang = '4' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IWANSE2047' or a.parent='IWANSE2047')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-15'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-06-01'	and '2020-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2020-01-01'	and '2020-10-14'  and  a.cabang = '42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-01-01'	and '2020-10-14'  and  a.cabang =  '42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2020-01-01'	and '2020-10-14'  and  a.cabang = '42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-05-01'	and '2019-12-31'  and  a.cabang =  '42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-15'  and  a.cabang = '18'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-01-01'	and '2020-10-15'  and  a.cabang =  '42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='KARELA2147' or a.parent='KARELA2147')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-05-01'	and '2019-12-31'  and  a.cabang =  '42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='KARELA2147' or a.parent='KARELA2147')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-10-15'  and  a.cabang = '40'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-15'   AND  a.cabang='8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-15'   AND  a.cabang='8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-15'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '--'	and '--'  and  a.cabang = '37' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='PARNI1806' or a.parent='PARNI1806')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '--'	and '--'  and  a.cabang = '37' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='PARNI1806' or a.parent='PARNI1806')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-01-07'  and  a.cabang = '37' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='PARNI1806' or a.parent='PARNI1806')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-07-01'	and '2020-01-31'  and  a.cabang = '37' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='PARNI1806' or a.parent='PARNI1806')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-10-16'  and  a.cabang =  '18'select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2020-01-01'	and '2020-10-16'  and  a.cabang = '18'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-10-16'   AND  a.cabang='18'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-10-01'	and '2020-10-16'  and  a.cabang = '37' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='PARNI1806' or a.parent='PARNI1806')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-07-01'	and '2020-10-16'  and  a.cabang = '37' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='PARNI1806' or a.parent='PARNI1806')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-10-16'  and  a.cabang =  '18'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-16' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-07-01'	and '2020-11-12'  and  a.cabang = '37' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IRFANS3192' or a.parent='IRFANS3192')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-16'  and  a.cabang = ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-15' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-15' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-05-31'  and  a.cabang = '35'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.produk = ''  and  a.cabang =  '' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '5' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-08-31'  and  a.cabang =  '5' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-08-31'  and  a.cabang =  '5' and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2019-08-01' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-09-01'	and '2019-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-11-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-02-29' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-03-01'	and '2020-04-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-05-01'	and '2020-09-30' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-09-30'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-07-01'	and '2020-11-10'  and  a.cabang = '37' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IRFANS3192' or a.parent='IRFANS3192')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-15'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-02' AND '2020-10-18'   AND  a.cabang='8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-08-01'	and '2020-10-16'  and  a.cabang = '16' and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-08-01'	and '2020-10-16'  and  a.cabang = '16' and  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2017-01-01' AND '--'   AND  a.produk=''  AND  a.cabang='' AND  a.asuransi =  ''SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2017-01-01' AND '2020-08-10'   AND  a.cabang='28'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-02-02'	and '2020-06-08'  and  a.produk = 'PR01'  and  a.cabang =  '5' and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-03-01'	and '2020-10-19'  and  a.cabang =  '21'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2019-03-01'	and '2020-10-19'  and  a.cabang =  '21'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2019-03-01'	and '2020-10-19'  and  a.cabang = '21'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-03-01'	and '2020-10-19'  and  a.cabang =  '21'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-06-01' AND '2020-10-19'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '22'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '--'	and '--'  and  a.cabang =  '22'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2019-07-01'	and '2020-10-19'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2019-07-01'	and '2020-10-19'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-10-19'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-07-01'	and '2020-10-19'  and  a.cabang = '29'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-15'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-16'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-16'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2014-10-30'	and '2020-10-19'  and  a.cabang = '11'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '--'	and '--'  and  a.produk = 'PN01'  and  a.cabang = '8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '--'	and '--'  and  a.produk = 'PN01'  and  a.cabang = '8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-09-01'	and '--'  and  a.produk = 'PN01'  and  a.cabang = '8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-09-01'	and '--'  and  a.produk = 'PN01'  and  a.cabang = '8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-09-01'	and '--'  and  a.produk = 'PN01'  and  a.cabang = '8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-03-05'	and '2020-03-05'  and  a.produk = 'PN01'  and  a.cabang = '8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-03-05'	and '2020-03-05'  and  a.produk = 'PS01'  and  a.cabang = '8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-03-05'	and '2020-03-05'  and  a.produk = 'PS01'  and  a.cabang = '8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-10-20'  and  a.cabang = '8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-10-20'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-09-30'  and  a.cabang = '59'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-01-01'	and '2020-10-20'  and  a.cabang =  '60' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='EDYRUS3053' or a.parent='EDYRUS3053')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-10-20'  and  a.cabang = '60' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='EDYRUS3053' or a.parent='EDYRUS3053')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-01-01' AND '2020-10-20'   AND  a.cabang='60' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='EDYRUS3053' or a.parent='EDYRUS3053')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-21'   AND  a.cabang='8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-21'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-07-01'	and '2020-10-22'  and  a.cabang = '37' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='IRFANS3192' or a.parent='IRFANS3192')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-10-22'  and  a.cabang = '33' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUSRAN0663' or a.parent='YUSRAN0663')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-10-22'  and  a.cabang = '43' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='DENIKU3040' or a.parent='DENIKU3040')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-10-22'  and  a.cabang = '33' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUSRAN0663' or a.parent='YUSRAN0663')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-06-01'	and '2020-10-22'  and  a.cabang = '33' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUSRAN0663' or a.parent='YUSRAN0663')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-10-22'  and  a.produk = 'PR01'  and  a.cabang = '33' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUSRAN0663' or a.parent='YUSRAN0663')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-10-22'  and  a.produk = 'PR01'  and  a.cabang = '33' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUSRAN0663' or a.parent='YUSRAN0663')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-06-01'	and '2020-10-22'  and  a.cabang = '33' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUSRAN0663' or a.parent='YUSRAN0663')) select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-06-30'  and  a.cabang = '33' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUSRAN0663' or a.parent='YUSRAN0663')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-03-02' AND '2020-10-23'   AND  a.cabang='8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2015-01-01' AND '2020-22-10'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2015-01-01' AND '2020-22-10'   AND  a.cabang='28'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-07-01'	and '2020-08-30'  and  a.cabang = '3'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra   from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  where  a.status='20' and left(a.createdt,10) between '2019-07-01'	and '2020-08-30'  and  a.cabang = '3'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2019-07-01'	and '2020-10-23' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2019-07-01'	and '2020-10-23' SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    Noregister,
                      a.nopeserta             Nopinjaman,
                      a.nama,
                      Concat('`', a.noktp)    noktp,
                      jkel,
                      pekerjaan,
                      b.msdesc                cabang,
                      tgllahir,
                      mulai,
                      a.akhir,
                      a.masa,
                      a.tunggakan             graceperiod,
                      up,
                      tpremi                  premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'status',
                      a.createdt              tglinput,
                      a.validdt               tglvalidasi,
                      Concat('`', a.policyno) nosertifikat,
                      e.paiddt                tglbayarpremi,
                      e.paidamt               JmlbayarPremi,
                      h.tglbatal,
                      h.sisa,
                      d.paiddt                tglrefundbayar,
                      h.refund                refundbayar
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2019-07-01' AND '2020-10-23'select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-07-01'	and '2020-10-23' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2019-08-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-09-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-09-01'	and '2019-11-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-09-01'	and '2019-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-11-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-01-01'	and '2020-02-29' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-03-01'	and '2020-04-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-05-01'	and '2020-10-23' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-01-01' AND '2020-10-23'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-07-01'	and '2020-08-31'  and  a.cabang =  '3'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-08-31'  and  a.cabang = '3'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-09-30'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-10-01'  and  a.produk = 'PR01'  and  a.cabang = '10' and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-10-01'  and  a.produk = 'PR01'  and  a.cabang = '10'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-06-30'	and '2020-10-26'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-27' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'MP01'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PS01'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PR01'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'MP01'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PS01'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PR01'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'MP01'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PS01'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PR01'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2019-05-01'	and '2020-10-31' SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    Noregister,
                      a.nopeserta             Nopinjaman,
                      a.nama,
                      Concat('`', a.noktp)    noktp,
                      jkel,
                      pekerjaan,
                      b.msdesc                cabang,
                      tgllahir,
                      mulai,
                      a.akhir,
                      a.masa,
                      a.tunggakan             graceperiod,
                      up,
                      tpremi                  premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'status',
                      a.createdt              tglinput,
                      a.validdt               tglvalidasi,
                      Concat('`', a.policyno) nosertifikat,
                      e.paiddt                tglbayarpremi,
                      e.paidamt               JmlbayarPremi,
                      h.tglbatal,
                      h.sisa,
                      d.paiddt                tglrefundbayar,
                      h.refund                refundbayar
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2019-05-01' AND '2020-10-31'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-05-01' AND '2020-10-31'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-05-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-05-01'	and '2019-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-10-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-10-01'	and '2019-11-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-12-01'	and '2020-01-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-02-01'	and '2020-03-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-04-01'	and '2020-05-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-06-01'	and '2020-10-31' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-28' AND '2020-11-02'   AND  a.cabang='8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2019-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2019-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2019-04-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-10-31'  and  a.cabang =  '6'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-06-01' AND '2020-11-02'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-02'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-05-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-05-01'	and '2019-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-10-01'	and '2020-01-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-10-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-10-01'	and '2019-11-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-12-01'	and '2020-01-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-02-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-02-01'	and '2020-05-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-02-01'	and '2020-04-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-05-01'	and '2020-07-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-08-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-05-01'	and '2019-08-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-09-01'	and '2019-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-11-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-03-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-04-01'	and '2020-06-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-07-01'	and '2020-10-31' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-07-01' AND '2020-10-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-05-01' AND '2020-10-31'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-06-01' AND '2020-11-03'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-05-01' AND '2020-10-31'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-31'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-03-31'  and  a.produk = 'PS01'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-03-31'  and  a.produk = 'PS01'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-04-01'	and '2020-10-31'  and  a.produk = 'PS01'  and  a.asuransi =  'MPM'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-10-01' AND '2020-10-31'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2020-10-31' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-31'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'MP01'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PS01'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PR01'  and  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PR01'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PS01'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'MP01'  and  a.asuransi =  'MPM'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'MP01'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PS01'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.produk = 'PR01'  and  a.asuransi =  'ETI'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-03'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-03'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-02' AND '2020-11-04'   AND  a.cabang='8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-07-01'	and '2019-08-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-09-01'	and '2019-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-11-01'	and '2019-12-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2019-11-01'	and '2020-02-29' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-02-29' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-03-01'	and '2020-04-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-05-01'	and '2020-06-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-07-01'	and '2020-08-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-09-01'	and '2020-11-04' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-06-01' AND '2020-06-30'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-04'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-09-01'	and '2020-09-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-11-06'  and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-11-06'  and  a.asuransi =  ''select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-11-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-11-06' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-11-06'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-10-01'	and '2019-10-31'  and  a.cabang = '40'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-11-01'	and '2020-11-11'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-10-01'	and '2020-10-31'  and  a.asuransi =  'ETI'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-07-01' AND '2020-11-11'   AND  a.cabang='42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-07-01' AND '2020-11-11'   AND  a.cabang='42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-07-01' AND '2020-11-11'   AND  a.cabang='42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-10'   AND  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-11-12'  and  a.cabang = '24'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-11-12'  and  a.cabang =  '29'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-11-01' AND '2020-11-12'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-10-31'   AND  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2019-07-01'	and '2020-11-12'  and  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-12'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-12'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-12'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-12'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-02'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-12'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-14'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-14'   AND  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-07-01'	and '2020-10-31' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-07-01'	and '2020-10-31' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-14'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-13'   AND  a.cabang='8'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-07-01'	and '2020-11-13'  and  a.cabang =  '29'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-06-01' AND '2020-11-16'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-13'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-08-01' AND '2020-11-16'   AND  a.cabang='51'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-16'   AND  a.cabang='51'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-13'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-06-01' AND '2020-11-17'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-02' AND '2020-11-17'   AND  a.cabang='8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-17'   AND  a.cabang='42' and a.createby in  (select  case when a.parent=a.username  then a.parent else a.username end from ms_admin a  where (a.username='YUFITA2128' or a.parent='YUFITA2128')) SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '--' AND '--'   AND  a.cabang='21'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2018-11-01' AND '2020-11-17'   AND  a.cabang='21'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-06-01' AND '2020-11-17'   AND  a.cabang='32'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-01-01'	and '2020-01-02' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-18'   AND  a.cabang='8'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-13'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-13'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-18'   AND  a.asuransi =  'TKP'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-10-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-10-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-10-31'  and  a.asuransi =  'ETI'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-05-01'	and '2020-11-20'  and  a.produk = 'PL01' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-05-01'	and '2020-11-20'  and  a.produk = 'PL01' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-09-04'	and '2019-09-04'  and  a.cabang = '38'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-20'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-22'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2020-11-01'	and '2020-11-23' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '--'	and '--'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '--'	and '--'  and  a.produk = 'PL01'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '--'	and '--'  and  a.produk = 'PL01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat,h.msdesc mitra  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     inner join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join ms_master h on a.mitra=h.msid and h.mstype='mitra'     inner join tr_sppa_paid d on d.regid=a.regid and d.paidtype='PREMI'   where   left(d.paiddt,10) between '2020-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2020-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2020-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang =  '29'SELECT f.msdesc               Produk,
                      Concat('`', a.regid)    Noregister,
                      a.nopeserta             Nopinjaman,
                      a.nama,
                      Concat('`', a.noktp)    noktp,
                      jkel,
                      pekerjaan,
                      b.msdesc                cabang,
                      tgllahir,
                      mulai,
                      a.akhir,
                      a.masa,
                      a.tunggakan             graceperiod,
                      up,
                      tpremi                  premi,
                      g.msdesc                Asuransi,
                      c.msdesc                'status',
                      a.createdt              tglinput,
                      a.validdt               tglvalidasi,
                      Concat('`', a.policyno) nosertifikat,
                      e.paiddt                tglbayarpremi,
                      e.paidamt               JmlbayarPremi,
                      h.tglbatal,
                      h.sisa,
                      d.paiddt                tglrefundbayar,
                      h.refund                refundbayar
                FROM   tr_sppa a
                      LEFT JOIN ms_master b
                             ON a.cabang = b.msid
                                AND b.mstype = 'cab'
                      LEFT JOIN ms_master c
                             ON a.status = c.msid
                                AND c.mstype = 'streq'
                      INNER JOIN ms_master f
                              ON a.produk = f.msid
                                 AND f.mstype = 'produk'
                      LEFT JOIN ms_master g
                             ON a.asuransi = g.msid
                                AND g.mstype = 'asuransi'
                      LEFT JOIN tr_sppa_paid d
                             ON d.regid = a.regid
                                AND d.paidtype = 'REFUND'
                      LEFT JOIN tr_sppa_paid e
                             ON e.regid = a.regid
                                AND e.paidtype = 'premi'
                      LEFT JOIN tr_sppa_cancel h
                             ON a.regid = h.regid
                WHERE  a.status IN ( '8', '81', '82', '83',
                                    '84', '85' )
                      AND LEFT(h.tglbatal, 10) BETWEEN '2019-07-01' AND '2020-11-23'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2020-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2020-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2020-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2020-01-01'	and '2020-11-23'  and  a.produk='PL01'  and  a.cabang='29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PL01'  and  a.cabang =  '29'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-23'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2019-01-01'	and '2020-11-23'  and  a.produk='PL01'  and  a.cabang='29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PR01'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PR01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2019-01-01'	and '2020-11-23'  and  a.produk='PR01'  and  a.cabang='29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PR01'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PR01'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PR01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PR01'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PR01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,d.paidamt jmlbayar,a.createdt tglinput,  concat('`',a.policyno) nosertifikat  from tr_sppa a  inner join ms_master b on a.cabang=b.msid and b.mstype='cab'  inner join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI' where   left(a.createdt,10)  between '2019-01-01'	and '2020-11-23'  and  a.produk = 'PR01'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2019-07-01'	and '2020-11-23' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('0','1') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,akhir,masa,a.tunggakan graceperiod,up,tpremi premi,  g.msdesc Asuransi,c.msdesc status,a.createdt tglinputa,a.nopeserta nopinjaman,REPLACE(REPLACE(REPLACE(concat(h.comment,' ',a.comment),'
',''),'	',''),'','') Ket  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_log h on a.regid=h.regid and h.status='12'     where a.status in ('12') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi,  d.paiddt Tglbayar,d.paidamt Jmlbayar  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='premi'  where a.status in ('5','20') and left(a.validdt,10) between '2019-01-01'	and '2020-11-23'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('2') and left(a.createdt,10) between '2019-01-01'	and '2020-11-23'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('3') and left(a.mulai,10) between '2019-01-01'	and '2020-11-23'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,a.up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('4')and  left(a.createdt,10)  between '2019-01-01'	and '2020-11-23'  and  a.cabang = '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai,a.akhir,a.masa,a.tunggakan graceperiod,up,  tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,concat('`',a.policyno) nosertifikat,a.validdt tglvalidasi  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('5') and left(a.validdt,10) between '2019-01-01'	and '2020-11-23'  and  a.cabang =  '29'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, a.akhir,a.masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,d.paiddt tglbayar,  a.createdt tglinput,a.validdt tglvalidasi,concat('`',a.policyno) nosertifikat,h.tglbatal from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     left join tr_sppa_paid d on d.regid=a.regid  and d.paidtype='PREMI'  left join tr_sppa_cancel h on a.regid=h.regid     where a.status in  ('7','71','72','73')  and  left(h.tglbatal,10)  between '2019-01-01'	and '2020-11-23'  and  a.cabang='29'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-01-01' AND '2020-11-23'  select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '--'	and '--' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-05-01'	and '2020-11-30' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa,a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput,a.policyno nosertifikat  from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     inner join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in (2,3,4,5) and left(a.createdt,10) between '2020-05-01'	and '2020-11-30' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-07-01' AND '2020-11-24'   AND  a.asuransi =  'TKP'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-01-01' AND '2020-11-23'  SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-10-01' AND '2020-11-24'   AND  a.cabang='51'select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-05-01'	and '2020-11-24' select f.msdesc produk,concat('`',a.regid) Noregister,a.nopeserta nopinjaman,a.nama,concat('`',a.noktp) noktp, jkel,pekerjaan,b.msdesc cabang,tgllahir,mulai, akhir,masa, a.tunggakan graceperiod,up,tpremi premi,g.msdesc Asuransi,c.msdesc status,a.createdt tglinput from tr_sppa a  left join ms_master b on a.cabang=b.msid and b.mstype='cab'  left join ms_master c on a.status=c.msid and c.mstype='streq'     left join ms_master f on a.produk=f.msid and f.mstype='produk'     left join ms_master g on a.asuransi=g.msid and g.mstype='asuransi'     where a.status in ('11') and left(a.createdt,10) between '2019-05-01'	and '2020-11-24' SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2019-06-01' AND '2020-11-25'   AND  a.cabang='51'SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '--' AND '--'   AND  a.produk=''  AND  a.cabang='' AND  a.asuransi =  ''SELECT f.msdesc                Produk,
                       Concat('`', a.regid)    NoRegister,
                       Concat('`', a.policyno) NoSertifikat,
                       a.nopeserta             NoPinjaman,
                       a.nama                  Nama,
                       a.jkel                  JenisKelamin,
                       o.msdesc                Pekerjaan,
                       b.msdesc                Cabang,
                       tgllahir                TglLahir,
                       mulai                   TglMulai,
                       Concat('`', a.noktp)    NoKTP,
                       akhir                   TglAkhir,
                       masa                    'Masa(bulan)',
                       a.tunggakan             Graceperiod,
                       a.up                    Plafond,
                       tpremi                  Premi,
                       g.msdesc                Asuransi,
                       c.msdesc                'Status',
                       a.createdt              TglInput,
                       e.paiddt                TglBayarPremi,
                       e.paidamt               JmlBayarPremi,
                       Concat('`', h.regclaim) NoClaim,
                       h.tglkejadian           TglKejadian,
                       h.tgllapor              TglLaporClaim,
                       h.nilaios               NilaiOS,
                       DATE_ADD(h.tglkejadian,INTERVAL (wkc.msdesc + wkc.createby) DAY) TglJatuhTempo,
                       a.validdt               TglValidasi,
                       h.validdt               TglValidClaim,
                       k.createdt              TglRejectClaim,
                       n.msdesc                AlasanReject,
                       h.comment               Keterangan,
                       j.createdt              TglTerimaDokumen,
                       d.paiddt                TglBayarClaim,
                       d.paidamt               JmlBayarClaim,
                       IF (dok.hasil IS NULL,
                            'Lengkap',
                            'Belum Lengkap')   StatusDokumen,
                       kurang.kelengkapan	     Kekurangan
                FROM   tr_sppa a
                       INNER JOIN ms_master b
                               ON a.cabang = b.msid AND b.mstype = 'cab'
                       INNER JOIN ms_master c
                               ON a.status = c.msid AND c.mstype = 'streq'
                       LEFT JOIN tr_sppa_paid d
                              ON d.regid = a.regid AND d.paidtype = 'CLAIM'
                       LEFT JOIN tr_sppa_paid e
                              ON e.regid = a.regid AND e.paidtype = 'PREMI'
                       INNER JOIN ms_master f
                               ON a.produk = f.msid AND f.mstype = 'produk'
                       INNER JOIN ms_master g
                               ON a.asuransi = g.msid AND g.mstype = 'asuransi'
                       INNER JOIN tr_claim h
                               ON a.regid = h.regid
                       INNER JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'KERJA') o
                              ON o.msid  = a.pekerjaan
                       LEFT JOIN ms_master i
                              ON i.msid = Concat(a.asuransi, a.produk) AND i.mstype = 'wktclm'
                       LEFT JOIN tr_sppa_log j
                              ON j.regid = a.regid AND j.status = '96'
                       LEFT JOIN tr_sppa_log k
                              ON k.regid = a.regid AND k.status = '94'
                       LEFT JOIN  (SELECT mstype,COUNT(msid) 'jmldokumen' FROM ms_master GROUP BY mstype) l
                              ON l.mstype = h.doctype
                       LEFT JOIN  (SELECT regid,COUNT(regid) 'uploaded' FROM tr_document WHERE catdoc='clm' GROUP BY regid) m
                              ON m.regid = a.regid 
                       LEFT JOIN  (SELECT msid, msdesc FROM ms_master WHERE mstype = 'REJECTTYPE') n
                              ON n.msid  = h.detail
                       LEFT JOIN  (SELECT msid, msdesc, createby FROM ms_master WHERE mstype='WKTCLM') wkc
                              ON wkc.msid = concat(a.asuransi,a.produk)
                       LEFT JOIN  (SELECT a.regid,
                                          GROUP_CONCAT(DISTINCT IF (b.editby = 'wajib' AND c.jnsdoc IS NULL,
                                          'Dokumen Belum Lengkap',
                                          null) SEPARATOR ', ')hasil
                                   FROM   tr_claim a
                                          INNER JOIN ms_master b
                                                  ON b.mstype = a.doctype
                                                     AND b.editby = 'wajib'
                                          LEFT JOIN tr_document c
                                                  ON c.regid = a.regid
                                                     AND c.jnsdoc = b.msid
                                   WHERE  b.createby IS NULL
                                          AND c.jnsdoc IS NULL
                                   GROUP BY regid) dok
                              ON dok.regid = a.regid
                        LEFT JOIN (SELECT a.regid,GROUP_CONCAT(trim(msdesc) SEPARATOR ', ') kelengkapan
                                   FROM tr_claim a
                                   INNER JOIN ms_master b 
                                        	ON a.doctype = b.mstype  
                                   LEFT JOIN tr_document c
                                        	ON c.regid = a.regid
                                           	AND c.jnsdoc = b.msid
                                   WHERE b.editby = 'wajib' and c.jnsdoc is null
                                   GROUP BY a.regid) kurang
                              ON kurang.regid = a.regid
                        WHERE  a.status IN ( '90', '91', '92', '93', '94', '95', '96' )
                              AND LEFT(h.tgllapor, 10) BETWEEN '2020-01-01' AND '2020-11-25'   AND  a.cabang='56' AND  a.asuransi =  ''